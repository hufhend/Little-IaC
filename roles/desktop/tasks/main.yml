---
- name: Ansible user doesn't log in via GUI
  ansible.builtin.lineinfile:
    path: "/var/lib/AccountsService/users/{{ ansible_user }}"
    regexp: '^SystemAccount='
    line: 'SystemAccount=true'

- name: Install smart desktop packages
  ansible.builtin.apt:
    pkg:
    - openvpn
    - network-manager-openvpn
    - network-manager-openvpn-gnome
    - openvpn-systemd-resolved
    - virtualbox
    - virtualbox-guest-additions-iso
    - virtualbox-ext-pack
    - nextcloud-desktop
    - flameshot
    - solaar
    - copyq
    - steam

- name: Install Google Chrome
  block:
  - name: Download Google Chrome DEB package
    ansible.builtin.get_url:
      url: https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
      dest: /tmp/google-chrome-stable_current_amd64.deb

  - name: Install Google Chrome
    ansible.builtin.apt:
      deb: /tmp/google-chrome-stable_current_amd64.deb
      state: present
  when: chrome == True

- name: Install OnlyOffice
  block:
  - name: Download OnlyOffice DEB package
    ansible.builtin.get_url:
      url: https://download.onlyoffice.com/install/desktop/editors/linux/onlyoffice-desktopeditors_amd64.deb
      dest: /tmp/onlyoffice-desktopeditors_amd64.deb

  - name: Install OnlyOffice
    ansible.builtin.apt:
      deb: /tmp/onlyoffice-desktopeditors_amd64.deb
      state: present
  when: onlyoffice == True